---
title: Result Interaction
keywords: guidanceresponse, rest,
tags: [rest,fhir,api]
sidebar: ctp_rest_sidebar
permalink: api_return_guidance_response.html
summary: Result Interaction
---

{% include custom/search.warnbanner.html %}
<!--
{% include custom/fhir.referencemin.html resource="" userlink="" page="" fhirname="GuidanceResponse" fhirlink="[GuidanceResponse](http://hl7.org/fhir/stu3/guidanceresponse.html)" content="User Stories" userlink="" %}

-->

## Result Interaction ##
The [GuidanceResponse](http://hl7.org/fhir/stu3/guidanceresponse.html) is the primary message generated by the Clinical Decision Support System (CDSS). It is returned by the CDSS in response to the EMS's `ServiceDefinition.$evaluate` operation.  
It carries the status of the response, any warnings or messages returned by the service, as well as the output data of the module and the result in the form of any suggested actions to be performed.  

Any triage interaction undertaken by a user needs to end by providing an appropriate recommendation as to what action to perform next.

Appropriate next steps could include:

- provision of care advice
- a referral to a healthcare provider
- (in the event of a technical failure) appropriate messaging that triage should be sought by alternative means

To facilitate the above user outcomes each ServiceDefinition should in turn end in:

- care advice
- a referral to a service
- redirection to a more appropriate ServcieDefinition based on the responses entered by the user

For example, a user might initially answer questions related to a ServiceDefinition for a rash. If their responses suggested potential meningitis, the system should have the ability to switch to a ServiceDefinition relating to meningitis so that an appropriate triage can be completed.

A ServiceDefinition may need to be capable of redirecting to multiple other ServiceDefinitions. For example, dependent on what answers are provided a ServiceDefinition relating to headache might need to redirect to ServiceDefinitions such as migraine, head injury or stroke. 

Given that a ServiceDefinition may redirect to other appropriate ServiceDefinitions there is potential for:

- a circular user journey, i.e. the user being asked questions that have already been answered earlier in the journey
- an unintended loop within the system, where ServiceDefinitions directly or indirectly redirect to each other

The possibility of this occurring will be based on the CDSS triage logic. Deploying organisations should configure their solution to prevent being directed back to a previous ServiceDefinition unintentionally.

It is recommended that testing is undertaken to ensure a given solution can prevent unintentional looping.


## Request Headers ##
The following HTTP request headers are supported for this interaction:  


| Header               | Value |Conformance |
|----------------------|-------|-------|
| `Accept`      | The `Accept` header indicates the format of the response the client is able to understand, this will be one of the following `application/fhir+json` or `application/fhir+xml`. See the RESTful API [Content types](api_general_guidance.html#content-types) section. | MAY |
| `Authorization`      | The `Authorization` header MUST carry a base64url encoded JSON web token. See the RESTful API [Security](api_security.html) section. | MUST |


## Key Aspects of the Return GuidanceResponse Interaction ##
Key aspects of this interaction which are of particular significance to implementers are noted below:  

### Outcome of the Triage Journey ###
This is carried in the `result` element of the `GuidanceResponse`. The outcome of the triage journey is displayed to the user by the EMS.  

There are three main outcomes for a triage journey and these are outlined below:-  

#### 1. Triage referral ####

A recommendation as to where the patient should go next; the `result` element in `GuidanceResponse` MUST be populated with a `RequestGroup` resource which will reference a `ReferralRequest`.  

The details of the referral carried in the `ReferralRequest` may be displayed to the user by the EMS.
  
View [CDS implementation guidance for a ReferralRequest](api_referral_request.html)  

#### 2. Care Advice ####

Care advice for the patient (or third party) on actions that can be performed now to either assist the patient, or to assist the triage process. 
  *  In the case of advice which is not self-care, the `result` element in `GuidanceResponse` MUST be populated with a `RequestGroup` resource which will reference a `ReferralRequest`. The `RequestGroup` will also reference one or more `CarePlans`.  
  *  In the case of advice to the patient relating to self-care, the `result` element in `GuidanceResponse` MUST be populated with a `RequestGroup` resource which will reference a `CarePlan`.  
Note that care advice can also be given at any point during a triage journey (even without a referral request). In this case, the `result` element MUST be populated with a `RequestGroup` which will reference a `CarePlan`.  

Any care advice carried in a `CarePlan` MUST be displayed to the user by the EMS.
	
View [CDS implementation guidance for a CarePlan](api_care_plan.html)  

#### 3. Redirection of the Service Definition ####

A recommendation to redirect to a different `ServiceDefinition`; the `result` element in `GuidanceResponse` SHOULD NOT be populated. Additionally, the [GuidanceResponse.dataRequirement](api_guidance_response.html#re-direction-to-a-new-servicedefinition) element will be used to carry a description of the data required by the EMS to enable it to select the new `ServiceDefinition` as directed by the CDSS.  
  
View [CDS implementation guidance for a GuidanceResponse](api_guidance_response.html)    
  
The final result or outcome of a triage journey will be available only when the `GuidanceResponse.status` is set to 'success'.  

### Status of the returned GuidanceResponse ###

The status of the `GuidanceResponse` is a trigger for the Encounter Management System (EMS). It MUST contain one of the following values: 

<table style="min-width:100%;width:100%">
<tr>
    <th style="width:25%;">Code</th>
    <th style="width:25%;">Display</th>
    <th style="width:50%;">Definition</th>
</tr>
<tr>
    <td><code class="highlighter-rouge">success</code></td>
      <td>Success</td>
    <td>The request was processed successfully</td>
 </tr>
<tr>
    <td><code class="highlighter-rouge">data-requested</code></td>
      <td>Data Requested</td>
    <td>The request was processed successfully, but more data may result in a more complete evaluation</td>
 </tr>
<tr>
    <td><code class="highlighter-rouge">data-required</code></td>
      <td>Data Required</td>
    <td>The request was processed, but more data is required to complete the evaluation</td>
 </tr>
</table>

#### Status of success ####
This means that the result is ready and no further `Questionnaires` are posted in the `GuidanceResponse`.  
The CDSS has all information possible for the `ServiceDefinition` to which the `GuidanceResponse` is responding and has provided a result.  
If the CDSS is recommending a referral to another service, the `GuidanceResponse.result` element will reference a `RequestGroup` which will in turn reference a `ReferralRequest` with a `status` of active. This referral may be accompanied by care advice (not self-care) and/or information about a procedure which the recommended service is expected to provide.  
If the CDSS is recommending care advice for a patient, the `result` element will reference a `RequestGroup` which will reference a `CarePlan` with a `status` of active.  
Alternatively, the `result` element will be null and the `GuidanceResponse.dataRequirement` element will be used to carry a description of the data required by the EMS to enable it to select the new `ServiceDefinition` as directed by the CDSS.  

The table below gives additional information relating to outcome scenarios when the `status` element of the `GuidanceResponse` is set to 'success':  


<table style="min-width:100%;width:100%">

<tr>
    <th style="width:35%;">Result</th>
    <th style="width:10%;">Status of the GuidanceResponse</th>
    <th style="width:30%;">Resource(s) referenced from GuidanceResponse</th>
   <th style="width:25%;">Additional information</th>
</tr>
<tr>
  <td>The CDSS has completed successfully with a recommendation of what service the patient should use next.</td>
    <td>success</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which in turn references <code class="highlighter-rouge">ReferralRequest</code> to carry the information pertinent to the recommended referral.</td>
<td>The <code class="highlighter-rouge">ReferralRequest</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>
</tr>
<tr>
  <td>The CDSS has completed successfully with a recommendation of what service the patient should use next and there is a known procedure which the referring service is intended to perform.</td>
    <td>success</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references <code class="highlighter-rouge">ReferralRequest</code> which in turn references <code class="highlighter-rouge">ProcedureRequest</code>.</td>
    <td>The <code class="highlighter-rouge">ReferralRequest</code> and the <code class="highlighter-rouge">ProcedureRequest</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>
</tr>
<tr>
  <td>The CDSS has completed successfully with a recommendation regarding what service the patient should use next and also some care advice (not self-care) for the patient. </td>
    <td>success</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references <code class="highlighter-rouge">ReferralRequest</code> which in turn references one or more <code class="highlighter-rouge">CarePlans</code>.</td>
    <td>The <code class="highlighter-rouge">ReferralRequest</code> and the <code class="highlighter-rouge">CarePlan</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>
</tr>
<tr>
  <td>The CDSS has completed successfully with some recommended care advice (self-care) for the patient.</td>
    <td>success</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references a <code class="highlighter-rouge">CarePlan</code>.</td>
    <td>The <code class="highlighter-rouge">CarePlan</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>
</tr>
<tr>
  <td>The CDSS has completed successfully and has re-directed the user to a new <code class="highlighter-rouge">ServiceDefinition</code>.</td>
    <td>success</td>
    <td><code class="highlighter-rouge">GuidanceResponse.result</code> is null and the <code class="highlighter-rouge">GuidanceResponse.dataRequirement</code> element will be used to carry a description of the data required by the EMS to enable it to select the new <code class="highlighter-rouge">ServiceDefinition</code>.</td>
    <td></td>
</tr>
</table>  
 
#### Status of data-requested ####
This means that the CDSS has sufficient information to render a result, but additional information will provide a better result. There are additional `Questionnaire` resources in the `GuidanceResponse` which SHOULD be answered.  
The `result` element in `GuidanceResponse` MUST be populated with a `RequestGroup` resource.  
If the CDSS is recommending an interim or initial recommendation relating to a referral to another service, the `RequestGroup` will reference a `ReferralRequest` in draft status.  
Care advice may additionally be given alongside this interim referral recommendation. If the CDSS is additionally recommending care advice (not self-care), the `ReferralRequest` will also reference a `CarePlan` in draft status.  
If the CDSS is recommending an interim or initial recommendation relating to care advice for the patient (self-care), the `RequestGroup` will reference a `CarePlan` in draft status.  
The `dataRequirement` element in `GuidanceResponse` MUST be populated with at least one `Questionnaire`.  

The table below gives additional information relating to outcome scenarios when the `status` element of the `GuidanceResponse` is set to 'data-requested':  


<table style="min-width:100%;width:100%">

<tr>
    <th style="width:35%;">Result</th>
    <th style="width:10%;">Status of the GuidanceResponse</th>
    <th style="width:30%;">Resource(s) referenced from GuidanceResponse</th>
   <th style="width:25%;">Additional information</th>
</tr>
<tr>
  <td>The CDSS has sufficient information to recommend a referral, but additional information will provide a better result.</td>
    <td>data-requested</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which in turn references <code class="highlighter-rouge">ReferralRequest</code> to carry the information pertinent to the recommended referral.</td>
<td>The <code class="highlighter-rouge">ReferralRequest</code> will have a <code class="highlighter-rouge">status</code> of 'draft' updating to 'active' when the finalised score is available.  When the result is final, the <code class="highlighter-rouge">GuidanceResponse.status</code> SHOULD be 'success' as above.</td>
</tr>
<tr>
  <td>The CDSS has sufficient information to make a recommendation regarding what service the patient should use next and there is also a recommendation relating to a care plan (not self-care).</td>
    <td>data-requested</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references <code class="highlighter-rouge">ReferralRequest</code> which in turn references <code class="highlighter-rouge">CarePlan</code>.</td>
<td>The <code class="highlighter-rouge">ReferralRequest</code> and the <code class="highlighter-rouge">CarePlan</code> will have a <code class="highlighter-rouge">status</code> of 'draft' updating to 'active' when the finalised score is available. When the result is final, the <code class="highlighter-rouge">GuidanceResponse.status</code> SHOULD be 'success' as above.</td>
</tr>
</table>

#### Status of data-required ####
This means that the CDSS has insufficient information to render an outcome.  There are additional `Questionnaire(s)` in the `GuidanceResponse` which MUST be answered.  
The `result` element in `GuidanceResponse` MAY be populated with a `RequestGroup`, for example referencing one or more `CarePlans` or one `ReferralRequest`.  
The CDSS can make a referral during the triage journey, and also wish to continue the triage process.  This is referred to as an inline referral, and is commonly done for Ambulance Despatch.  
This can be represented by setting `GuidanceResponse.status` to 'data-required', but populating the `result` element with a `ReferralRequest` resource with a `status` of 'active'.  Care advice can be given with this inline referral (not self-care).
The CDSS can also recommend inline care advice (self care).
The `dataRequirement` element in `GuidanceResponse` MUST be populated with at least one `Questionnaire`.  

The table below gives additional information relating to outcome scenarios when the `status` element of the `GuidanceResponse` is set to 'data-required':  


<table style="min-width:100%;width:100%">

<tr>
    <th style="width:35%;">Result</th>
    <th style="width:10%;">Status of the GuidanceResponse</th>
    <th style="width:30%;">Resource(s) referenced from GuidanceResponse</th>
   <th style="width:25%;">Additional information</th>
</tr>
<tr>
  <td>The CDSS is requesting additional information from the EMS using a <code class="highlighter-rouge">Questionnaire</code> resource.</td>
    <td>data-required</td>
    <td>A <code class="highlighter-rouge">GuidanceResponse</code> is returned which references one or more <code class="highlighter-rouge">Questionnaires</code>.</td>
<td></td>
</tr>
<tr>
  <td>The CDSS is making an inline referral.</td>
     <td>data-required</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references <code class="highlighter-rouge">ReferralRequest</code>.</td>
<td>The <code class="highlighter-rouge">ReferralRequest</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>
</tr>
<tr>
  <td>The CDSS is making an inline referral with care advice (not self-care).</td>
     <td>data-required</td>
    <td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references <code class="highlighter-rouge">ReferralRequest</code> which in turn references <code class="highlighter-rouge">CarePlan</code>.</td>
<td>The <code class="highlighter-rouge">ReferralRequest</code> and the <code class="highlighter-rouge">CarePlan</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>
</tr>
<tr>
  <td>The CDSS is giving inline care advice (self-care).</td>
     <td>data-required</td>
	<td><code class="highlighter-rouge">GuidanceResponse</code> references <code class="highlighter-rouge">RequestGroup</code> which references a <code class="highlighter-rouge">CarePlan</code>.</td>
    <td>The <code class="highlighter-rouge">CarePlan</code> will have a <code class="highlighter-rouge">status</code> of 'active'.</td>    
</tr>
</table>

### OutputParameters of the returned GuidanceResponse ###  
The `GuidanceResponse.outputParameters` element carries assertions (resulting from the EMS’s responses to received questions) sent to the EMS by the CDSS. It also carries the `QuestionnaireResponse` resources created by the EMS, from user input. Where the data carried in `outputParameters` can be interpreted by a system, it SHOULD be published as an assertion, typically by populating an  [Observation](http://hl7.org/fhir/stu3/observation.html) resource. This is done by the CDSS when it receives responses to received questions from the EMS.

If the information can only be interpreted by a human, it SHOULD be maintained as a [QuestionnaireResponse](http://hl7.org/fhir/stu3/questionnaireresponse.html) only. The [logical ID](http://hl7.org/fhir/STU3/resource.html#id) of either or both of these resources can be returned to the EMS by the CDSS for persistence and these IDs are carried as a reference in this element throughout the triage journey.

## GuidanceResponse: Implementation Guidance ##
View [CDS implementation guidance for a GuidanceResponse](api_guidance_response.html).
